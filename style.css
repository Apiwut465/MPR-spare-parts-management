/* ===== Theme tokens ===== */
:root{
  --bg:#f6f9fc; --ink:#0f172a; --muted:#64748b; --line:#e2e8f0;
  --pri:#2563eb; --ok:#16a34a; --warn:#f59e0b; --danger:#ef4444;
  --card:#fff; --chip:#eef2ff; --radius:18px;
}

*{box-sizing:border-box;font-family:'Noto Sans Thai',system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);font-weight:400}

/* Container */
.container{max-width:1100px;margin:0 auto 84px auto;padding:14px 16px}
@media (min-width:720px){ .container{padding:14px 16px 110px}}

/* Header */
header{position:sticky;top:0;z-index:9;background:linear-gradient(#ffffffcc,#ffffffcc),var(--bg);
  backdrop-filter:saturate(1.5) blur(10px);border-bottom:1px solid var(--line)}
.h-wrap{display:flex;align-items:center;gap:12px;padding:12px 16px}
.brand{font-weight:600}
.pill{padding:4px 10px;border-radius:999px;background:var(--chip);font-size:12px;color:#334155}
.grow{flex:1}

/* Cards / form basics */
.card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);
  box-shadow:0 8px 24px rgba(2,6,23,.06);padding:14px;transition:box-shadow .2s ease, transform .2s ease}
.card:hover{box-shadow:0 14px 36px rgba(2,6,23,.10);transform:translateY(-1px)}
.grid{display:grid;gap:12px}
.grid-2{grid-template-columns:1fr 1fr}
.row{display:grid;gap:8px}
label{font-weight:500;font-size:14px}
input,select{width:100%;padding:12px 14px;border:1px solid var(--line);border-radius:12px;font-size:15px;background:#fff}
input:focus,select:focus{outline:none;border-color:var(--pri);box-shadow:0 0 0 3px rgba(37,99,235,.15)}
button{cursor:pointer;border:none;background:var(--pri);color:#fff;font-weight:600;padding:12px 16px;border-radius:12px;transition:transform .15s ease, box-shadow .15s ease}
button:active{transform:translateY(1px)}
button.secondary{background:#f3f4f5;color:#0a0a0a}
button.secondary2{background:#ee4848;color:#0a0a0a}
.meta{font-size:12px;color:var(--muted)}
.name{font-weight:500}

/* KPI */
.kpi-row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
.kpi-box{position:relative;background:#fff;border:1px solid var(--line);border-radius:20px;padding:18px 20px 20px 24px;box-shadow:0 10px 24px rgba(2,6,23,.06)}
.kpi-box::before{content:"";position:absolute;left:10px;top:10px;bottom:10px;width:10px;border-radius:20px}
.kpi-head{color:#64748b;font-weight:300}
.kpi-num{font-size:30px;font-weight:450;letter-spacing:.2px;color:#0f172a;padding-left: 10%;}
.kpi-green{background:#e8f5e9}.kpi-green::before{background:#22c55e}
.kpi-orange{background:#fff3e2}.kpi-orange::before{background:#f59e0b}
.kpi-red{background:#ffe4e6}.kpi-red::before{background:#ef4444}

/* Alerts */
.card.soft{border-radius:18px}
.section-title{margin:4px 0 8px;font-weight:600}
.legend{font-size:13px;color:#64748b;margin:2px 0 10px;display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.legend .dot{width:10px;height:10px;border-radius:50%}
.legend .dot.red{background:#ef4444}.legend .dot.orange{background:#f59e0b}
.alert-list{display:grid;gap:8px}
.alert-item{display:flex;gap:10px;align-items:center;background:#fff;border:1px solid var(--line);border-radius:14px;padding:10px 12px}
.alert-title{font-weight:600}
.alert-meta{font-size:12px;color:#64748b}
.t-red{color:#b91c1c}.t-orange{color:#b45309}

/* Gallery */
.gallery{display:grid;gap:12px;padding-top:12px;grid-template-columns:repeat(auto-fill, minmax(320px,1fr))}
.gcard{background:#fff;border:1px solid var(--line);border-radius:16px;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 8px 24px rgba(2,6,23,.06)}
.gimg{width:100%;aspect-ratio:4/3;object-fit:cover;background:#eef2f7;border-bottom:1px solid var(--line)}
.gbox{padding:10px 12px;display:grid;gap:6px}
.gmeta{display:flex;gap:8px;flex-wrap:wrap;font-size:12px;color:#64748b}
.gmeta span{background:#f1f5f9;border:1px solid #e2e8f0;border-radius:999px;padding:2px 8px}
.gactions{display:flex;gap:8px;padding:10px 12px;border-top:1px dashed var(--line)}
.gactions .qty{width:110px}.gactions .grow{flex:1}

/* Table (Stock list) */
.tbl-wrap{overflow:auto;border:1px solid var(--line);border-radius:12px;background:#fff}
.tbl{width:100%;border-collapse:separate;border-spacing:0}
.tbl thead th{position:sticky;top:0;background:#f8fafc;border-bottom:1px solid var(--line);text-align:left;font-weight:600;font-size:13px;color:#334155;padding:10px 12px}
.tbl tbody td{padding:10px 12px;border-bottom:1px solid #f1f5f9;font-size:14px;color:#0f172a;vertical-align:middle}
.tbl tbody tr:last-child td{border-bottom:none}
.act{display:flex;gap:8px}
.btn-xs{padding:6px 10px;border-radius:8px;font-size:12px;border:1px solid var(--line);background:#f8fafc;color:#0f172a}
.btn-xs:hover{background:#eef2ff;border-color:#c7d2fe}
.btn-danger{background:#fee2e2;color:#b91c1c;border-color:#fecaca}
.btn-danger:hover{background:#fecaca}

/* Notifications */
/* ==== Modern Toasts =================================================== */
.noti-stack{
  position:fixed;
  right:16px;
  top:14px;
  display:flex;
  flex-direction:column;
  gap:12px;
  z-index:5000;             /* ให้ลอยเหนือโมดัล */
  pointer-events:none;       /* ไม่บังการคลิกเนื้อหาข้างใต้ */
}

.noti{
  pointer-events:auto;
  position:relative;
  min-width:260px; max-width:360px;
  display:grid; grid-template-columns:auto 1fr auto; gap:10px;
  padding:12px 12px;
  border-radius:16px;
  color:#fff;
  background: rgba(15,23,42,.86); /* glass dark */
  border:1px solid rgba(255,255,255,.08);
  backdrop-filter: blur(12px) saturate(1.2);
  -webkit-backdrop-filter: blur(12px) saturate(1.2);
  box-shadow: 0 14px 40px rgba(2,6,23,.34);
  transform-origin: top right;
  animation: toastIn .24s cubic-bezier(.2,.9,.2,1) both;
  overflow:hidden;
}

/* โทนสีตาม level */
.noti--info   { --bar:#60a5fa; }
.noti--warn   { --bar:#f59e0b; }
.noti--danger { --bar:#ef4444; }

/* ไอคอน */
.noti__icon{
  width:28px; height:28px; border-radius:10px;
  display:grid; place-items:center;
  background: radial-gradient(120% 120% at 30% 20%, var(--bar) 55%, #0000);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.25);
  font-size:16px; line-height:1;
}

/* เนื้อหา */
.noti__title{ font-weight:700; font-size:14px; letter-spacing:.2px; }
.noti__msg{ font-size:12px; color:#cbd5e1; }

/* ปุ่มปิด */
.noti__close{
  align-self:start;
  width:28px; height:28px;
  border:0; background:transparent; color:#fff; opacity:.7;
  border-radius:8px; cursor:pointer;
}
.noti__close:hover{ opacity:1; background:rgba(255,255,255,.08); }

/* แถบเวลาหมดอายุ */
.noti__progress{
  position:absolute; left:0; right:0; bottom:0; height:3px;
  background:linear-gradient(to right, var(--bar), transparent);
  opacity:.9;
  transform-origin:left;
  animation: notiLife var(--life, 2800ms) linear forwards;
}
.noti.paused .noti__progress{ animation-play-state: paused; }

/* สถานะออก */
.noti.out{ animation: toastOut .2s ease forwards; }

/* Animations */
@keyframes toastIn{
  from{ opacity:0; transform: translateY(-6px) scale(.98) rotate(-.5deg); }
  to  { opacity:1; transform: translateY(0)    scale(1); }
}
@keyframes toastOut{
  to{ opacity:0; transform: translateY(-6px) scale(.98); }
}
@keyframes notiLife{
  from{ transform: scaleX(1); }
  to  { transform: scaleX(0); }
}

/* ลด motion สำหรับผู้ใช้ที่ตั้งค่าไว้ */
@media (prefers-reduced-motion: reduce){
  .noti{ animation:none }
  .noti__progress{ animation:none }
}


/* Bottom Navigation (glass) */
.bottom-nav {
  --count: 7;
  --i: 0;
  position: fixed;
  left: 50%;
  bottom: max(10px, env(safe-area-inset-bottom));
  transform: translateX(-50%);
  width: min(820px, 96vw);
  height: 72px;
  padding: 0 10px;
  display: flex;
  justify-content: space-around;
  align-items: center;
  background: rgba(180, 198, 255, 0.3);
  border: 1px solid rgba(200, 200, 255, 0.4);
  border-radius: 22px;
  backdrop-filter: blur(20px) saturate(1.6);
  -webkit-backdrop-filter: blur(20px) saturate(1.6);
  box-shadow: 0 14px 50px rgba(80, 100, 255, 0.2),
              inset 0 1px 0 rgba(255, 255, 255, 0.5),
              inset 0 -1px 0 rgba(180, 180, 255, 0.1);
  z-index: 999;
  transition: transform .35s ease, opacity .35s ease;
}
.bottom-nav.hide{ transform: translate(-50%,110%); opacity:.85; }

/* sheen animation */
.bottom-nav::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(110deg, transparent 0 40%,
              rgba(255, 255, 255, 0.2) 50%, transparent 60%);
  mix-blend-mode: screen;
  animation: sheen 6s ease-in-out infinite;
  pointer-events: none;
}
@keyframes sheen {
  0% { transform: translateX(-60%); }
  50% { transform: translateX(40%); }
  100% { transform: translateX(120%); }
}

/* indicator */
.bottom-nav::after {
  content: "";
  position: absolute;
  top: 8px;
  bottom: 8px;
  width: calc(100% / var(--count) - 14px);
  left: calc((100% / var(--count)) * var(--i) + 7px);
  border-radius: 14px;
  background: radial-gradient(80% 80% at 30% 20%, #fff 0%, #dbeafe00 100%);
  box-shadow: 0 8px 26px rgba(37, 99, 235, 0.4),
              inset 0 1px 0 rgba(255, 255, 255, 0.6);
  transition: left .3s cubic-bezier(.2,.9,.2,1);
  pointer-events: none;
}

.nav-btn{
  position: relative; flex: 1; height: 100%;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 4px; padding-top: 4px; padding-bottom: 4px;
  font-size: 22px; color: #6b7280; background:none;border:0;outline:0;
  -webkit-tap-highlight-color:transparent; transition: color 0.2s, transform 0.2s;
}
.nav-btn span{ font-size:12px; font-weight:600; }
.nav-btn.active{ color:#2563eb; transform: translateY(-2px) scale(1.06); }
.nav-btn.active span{ color:#2563eb; }
.nav-btn:hover{ transform: translateY(-1px); }
.nav-btn .ripple{
  position:absolute;width:12px;height:12px;border-radius:50%;
  background: radial-gradient(circle, rgba(37,99,235,0.35) 0%, rgba(37,99,235,0) 60%);
  transform: translate(-50%,-50%) scale(0);
  animation: ripple .6s ease-out forwards;
}
@keyframes ripple{ to{ transform: translate(-50%,-50%) scale(9); opacity:0; } }
@keyframes bounceIn{ 0%{transform:translateY(6px) scale(.9)} 60%{transform:translateY(-2px) scale(1.08)} 100%{transform:translateY(0) scale(1)} }
.nav-btn.bouncing{ animation: bounceIn .38s cubic-bezier(.2,.9,.2,1); }

/* Role hints (fallback) */
.bottom-nav[data-role="guest"]{ --count:2; }
.bottom-nav[data-role="admin"]{ --count:7; }

/* Premium Modal / Bottom Sheet */
body.modal-open{overflow:hidden}
.modal{position:fixed;inset:0;z-index:2000;display:none}
.modal.show{display:block}
.modal__backdrop{position:absolute;inset:0;background:#0f172a99;backdrop-filter:blur(2px)}
.modal__panel{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:min(560px,92vw);max-height:84vh;overflow:auto;background:#fff;border:1px solid #e5e7eb;border-radius:20px;box-shadow:0 24px 56px rgba(2,6,23,.25);display:flex;flex-direction:column;animation:popIn .18s ease-out}
@keyframes popIn{from{opacity:0;transform:translate(-50%,-48%) scale(.98)}}
@media (max-width:720px){
  .modal__panel{left:0;right:0;top:auto;bottom:0;transform:none;width:100%;max-height:88vh;border-radius:18px 18px 0 0;border-left:none;border-right:none;animation:sheetUp .22s cubic-bezier(.2,.9,.2,1)}
  @keyframes sheetUp{from{transform:translateY(16px);opacity:0}}
}
.modal__head{position:sticky;top:0;z-index:1;display:flex;align-items:center;justify-content:center;gap:8px;padding:14px 16px;border-bottom:1px solid #eef2f7;background:#fff;border-radius:20px 20px 0 0}
.modal__title{font-weight:600;font-size:16px;color:#0f172a}
.modal__close{position:absolute;left:12px;top:10px;width:36px;height:36px;display:grid;place-items:center;border-radius:10px;border:1px solid #e5e7eb;background:#fff;color:#0f172a;font-weight:700}
.modal__body{padding:14px 16px;display:grid;gap:10px}
.m-row{display:grid;gap:6px}
.m-row label{font-size:13px;color:#334155}
.m-row input,.m-row select{width:100%;padding:12px 14px;border:1px solid #e5e7eb;border-radius:12px;background:#fff;font-size:15px}
.m-row input:focus,.m-row select:focus{outline:none;border-color:var(--pri);box-shadow:0 0 0 3px rgba(37,99,235,.15)}
.modal__foot{position:sticky;bottom:0;z-index:1;display:flex;gap:8px;justify-content:flex-end;padding:12px 16px;border-top:1px solid #eef2f7;background:linear-gradient(#ffffffea,#ffffffea);border-radius:0 0 20px 20px}
.modal__foot .secondary{background:#0f172a0d;color:#0f172a}
.summary{display:flex;gap:12px;align-items:center}
.thumb-lg{width:64px;height:64px;border-radius:12px;object-fit:cover;background:#f1f5f9;border:1px solid #e5e7eb}

/* Chips */
.chipset{display:flex;gap:8px;flex-wrap:wrap}
.chip{padding:8px 12px;border-radius:999px;border:1px solid var(--line);background:#fff;color:#0f172a;font-size:13px;cursor:pointer}
.chip.is-active{background:#eef2ff;border-color:#c7d2fe;color:#1e40af}

/* Badges */
.badge{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;font-size:12px;font-weight:600}
.badge.in{background:#e8f5e9;color:#15803d;border:1px solid #bbf7d0}
.badge.out{background:#fee2e2;color:#b91c1c;border:1px solid #fecaca}
.badge.red{background:#fee2e2;color:#b91c1c;border:1px solid #fecaca}
.badge.orange{background:#fff7ed;color:#b45309;border:1px solid #fed7aa}
.badge.green{background:#e8f5e9;color:#15803d;border:1px solid #bbf7d0}

/* Receive: image uploader preview */
.uploader{display:flex;align-items:center;gap:10px}
.uploader img{width:84px;height:84px;border-radius:12px;object-fit:cover;background:#f1f5f9;border:1px solid #e5e7eb}

/* Utilities */
.page{padding:0}

/* Alert bars */
.alert-item.bar-red { border-left: 8px solid #e63946; }
.alert-item.bar-orange { border-left: 8px solid #f4a261; }

/* =========================
   Modern Colorful Skin (History)
   วางต่อท้าย style.css
   ========================= */

/* 1) เติมโทนสี/เอฟเฟกต์ */
:root{
  --pri-50:#eef2ff; --pri-100:#e0e7ff; --pri-200:#c7d2fe;
  --pri-600:#2563eb; --pri-700:#1d4ed8;
  --ok-50:#ecfdf5; --ok-200:#a7f3d0;
  --shadow-1: 0 10px 30px rgba(37,99,235,.15);
  --shadow-2: 0 16px 40px rgba(2,6,23,.18);
}

/* 2) การ์ดหน้าประวัติ: glassy + gradient ขอบสี */
#page-history .card{
  background:
    linear-gradient(180deg,#ffffffcc,#ffffffee),
    radial-gradient(140% 90% at 0% 0%, #dbeafe66 0%, transparent 60%),
    radial-gradient(120% 80% at 100% 0%, #f0f9ff66 0%, transparent 60%);
  border: 1px solid var(--pri-100);
  box-shadow: var(--shadow-1);
}
#page-history .card:hover{ box-shadow: var(--shadow-2); }

/* 6) ปรับ badge ประเภทให้พรีเมียมขึ้น */
.badge{
  padding: 6px 10px;
  border-radius: 999px;
  font-weight: 700;
  letter-spacing:.2px;
  box-shadow: 0 6px 16px rgba(2,6,23,.08), inset 0 1px 0 rgba(255,255,255,.6);
}
.badge.in{
  background: linear-gradient(180deg,#e8fdf3,#d1fae5);
  color:#047857;
  border:1px solid #a7f3d0;
}
.badge.out{
  background: linear-gradient(180deg,#fee2e2,#fecaca);
  color:#b91c1c;
  border:1px solid #fecaca;
}

/* 7) ปุ่มต่าง ๆ */
#page-history button.secondary{
  background: #eef2ff;
  color:#1e40af;
  border:1px solid var(--pri-200);
}
#page-history button.secondary:hover{
  filter: saturate(1.1);
  box-shadow: 0 10px 24px rgba(78, 131, 247, 0.18);
}
#page-history .btn-xs{
  background:#f8fafc;
  border-color:#e5e7eb;
}
#page-history .btn-xs:hover{
  background:#eef2ff; border-color:#c7d2fe;
}

/* 8) ไอคอนสถานะด้านซ้าย (ถ้าต้องการเน้นแถว) */
#page-history .tbl tbody tr:hover td:first-child{
  position: relative;
}
#page-history .tbl tbody tr:hover td:first-child::before{
  content:'';
  position:absolute; left:-12px; top:8px; bottom:8px; width:6px;
  border-radius:8px;
  background: linear-gradient(180deg,var(--pri-600),var(--pri-700));
}

/* 9) ปรับ meta / สีตัวอักษรเล็ก */
#page-history .meta{ color:#64748b; }

/* 10) รองรับจอเล็ก: ซ่อนเงาเกิน, เพิ่ม spacing */
@media (max-width: 720px){
  #page-history .card{ border-radius: 16px; }
  #page-history .tbl thead th, 
  #page-history .tbl tbody td{ padding: 10px 10px; }
}
/* ==== Vivid header: History page only ==== */
#page-history .tbl thead th{
  position: sticky; top: 0; z-index: 2;
  color:#ffffff;
  background: linear-gradient(180deg, var(--pri,#a7bff2), #5894eeda);
  border: none;
  text-transform: uppercase;
  font-weight: 800;
  letter-spacing: .35px;
  box-shadow: 0 2px 0 rgba(0,0,0,.06), inset 0 -3px 0 #93c5fd;
}
#page-history .tbl thead th:first-child{ border-radius: 12px 0 0 12px; }
#page-history .tbl thead th:last-child { border-radius: 0 12px 12px 0; }
/* --- Make notifications float above modal/backdrop --- */
.noti-stack{
  position: fixed;
  right: 16px;
  top: 12px;
  z-index: 5000 !important;   /* > .modal (2000) */
  pointer-events: none;        /* ไม่บังการคลิกพื้นหลัง */
}
.noti{
  pointer-events: auto;        /* ถ้ามีปุ่ม/ลิงก์ใน noti ยังคลิกได้ */
}
#btnLang{
  background:#68aff7;color:#0f172a;border:1px solid #e2e8f0;
}
#btnLang:hover{ background:#a9c7f0; }
/* =========================================================
   HISTORY — Neo-Modern Skin (drop-in, no HTML changes)
   – ใส ๆ แบบ glass, gradient header, pill chips, hover lift –
   ========================================================= */
#page-history{
  --hx: 12px;                      /* radius */
  --bg-card: linear-gradient(180deg,#ffffffd8,#ffffffe9),
              radial-gradient(120% 80% at 0% 0%, #dbeafe55 0%, transparent 60%),
              radial-gradient(120% 80% at 100% 0%, #f0f9ff55 0%, transparent 60%);
  --bd-card: #e6edff;
  --shadow-1: 0 14px 40px rgba(37,99,235,.16), 0 6px 16px rgba(2,6,23,.08);
  --shadow-2: 0 18px 46px rgba(2,6,23,.18);
  --hdr-grad: linear-gradient(180deg,#3b82f6,#2563eb 70%);
  --hdr-glow: inset 0 -3px 0 #93c5fd, 0 1px 0 rgba(255,255,255,.7);
  --row-hover: rgba(37,99,235,.06);
  --chip-bg: #f1f5ff;
  --chip-bd: #dbe3ff;
  --chip-on: linear-gradient(180deg,#e5edff,#d7e2ff);
  --chip-on-bd:#b9c9ff;
}

/* การ์ดหลัก: glass + soft border */
#page-history .card{
  background: var(--bg-card);
  border: 1px solid var(--bd-card);
  border-radius: 20px;
  box-shadow: var(--shadow-1);
  transition: box-shadow .2s ease, transform .2s ease, border-color .2s;
}
#page-history .card:hover{ box-shadow: var(--shadow-2); }

/* ช่องค้นหา: ไอคอนแว่น + focus ring สวย ๆ */
#page-history #hQ{
  padding-left: 42px;
  background:
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%2399a3b3' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='M21 21l-3.5-3.5'/%3E%3C/svg%3E") no-repeat 14px center / 18px;
}
#page-history #hQ:focus{
  border-color:#60a5fa;
  box-shadow: 0 0 0 4px rgba(96,165,250,.25);
}

/* select ให้ดูเนียน ๆ (ไม่ต้องแก้ HTML) */
#page-history select{
  appearance:none;
  background:
    linear-gradient(#fff,#fff) padding-box,
    linear-gradient(180deg,#e2e8f0,#e2e8f0) border-box,
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%2364758b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E") no-repeat right 12px center / 18px;
  border-radius: 14px;
  border:1px solid #e2e8f0;
  padding-right: 40px;
}
#page-history select:focus{
  border-color:#60a5fa;
  box-shadow: 0 0 0 4px rgba(96,165,250,.22);
}

/* ชุดปุ่มประเภท (chips) */
#page-history .chipset{ gap:10px }
#page-history .chip{
  background: var(--chip-bg);
  border-color: var(--chip-bd);
  font-weight: 600;
  color:#334155;
  transition: transform .12s ease, box-shadow .15s ease, background .15s ease, border-color .15s;
}
#page-history .chip:hover{ transform: translateY(-1px); box-shadow: 0 6px 18px rgba(2,6,23,.08); }
#page-history .chip.is-active{
  background: var(--chip-on);
  border-color: var(--chip-on-bd);
  color:#1e40af;
  box-shadow: 0 8px 22px rgba(78,131,247,.18);
}

/* กล่องตาราง: ทำให้ดู float + มี scroll shadow */
#page-history .tbl-wrap{
  border-radius: 14px;
  border: 1px solid #e3e8f5;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.6), 0 10px 26px rgba(2,6,23,.08);
  background: #ffffffcc;
  backdrop-filter: blur(2px);
  overflow: auto;
}

/* หัวตาราง: gradient + ตัวพิมพ์เล็กหนา + แสง */
#page-history .tbl thead th{
  position: sticky; top: 0; z-index: 2;
  background: var(--hdr-grad);
  color: #fff;
  border: none;
  text-transform: uppercase;
  font-weight: 500;
  letter-spacing: .35px;
  box-shadow: var(--hdr-glow);
}
#page-history .tbl thead th:first-child{ border-radius: 12px 0 0 12px; }
#page-history .tbl thead th:last-child { border-radius: 0 12px 12px 0; }

/* แถวข้อมูล: แยกเส้นนุ่ม ๆ + hover ยกนิด ๆ */
#page-history .tbl tbody td{
  border-bottom: 1px solid #eef2f7;
  padding: 12px 14px;
}

#page-history .tbl tbody tr:hover{
  background: var(--row-hover);
  transform: translateY(-1px);
  box-shadow: 0 8px 18px rgba(2,6,23,.06) inset;
}

/* ไอคอนสถานะซ้ายเมื่อ hover */
#page-history .tbl tbody tr:hover td:first-child{
  position: relative;
}
#page-history .tbl tbody tr:hover td:first-child::before{
  content:'';
  position:absolute; left:-10px; top:8px; bottom:8px; width:6px;
  border-radius:8px;
  background: linear-gradient(180deg,#60a5fa,#2563eb);
}

/* ปรับ badge ให้พรีเมียมขึ้น */
#page-history .badge{
  padding: 6px 10px; font-weight: 500; letter-spacing:.2px;
  border-radius: 99px;
  box-shadow: 0 6px 16px rgba(2,6,23,.08), inset 0 1px 0 rgba(255,255,255,.6);
}
#page-history .badge.in{
  background: linear-gradient(180deg,#e7fff4,#d1fae5);
  color:#047857; border:1px solid #a7f3d0;
}
#page-history .badge.out{
  background: linear-gradient(180deg,#ffe7e7,#fecaca);
  color:#e03737; border:1px solid #fecaca;
}

/* ปุ่มย่อยในหน้า history */
#page-history .btn-xs{
  background:#f8fafc; border-color:#e5e7eb;
}
#page-history .btn-xs:hover{
  background:#eef2ff; border-color:#c7d2fe;
}
#page-history button.secondary{
  background:#eef2ff; color:#1e40af; border:1px solid #c7d2fe;
}
#page-history button.secondary:hover{
  filter:saturate(1.05); box-shadow: 0 8px 22px rgba(78,131,247,.2);
}

/* ว่างเปล่า */
#page-history .tbl tbody td.meta{
  color:#64748b; text-align:center; padding: 18px 12px !important;
}

/* Responsive tune */
@media (max-width: 720px){
  #page-history .card{ border-radius: 16px; }
  #page-history .tbl thead th, 
  #page-history .tbl tbody td{ padding: 10px 10px; }
  #page-history #hQ{ font-size: 14px; }
}
/* ===== Dashboard: Top 5 Issued ===== */
.top5-list{ display:grid; gap:10px; }
.top5-item{
  display:grid; grid-template-columns:36px 1fr auto; gap:10px; align-items:center;
  padding:10px 12px; background:#fff; border:1px solid var(--line);
  border-radius:12px; box-shadow:0 8px 24px rgba(2,6,23,.04);
}
.top5-rank{
  width:28px; height:28px; border-radius:10px; color:#fff; font-weight:700;
  display:grid; place-items:center;
  background:linear-gradient(180deg,#60a5fa,#2563eb);
  box-shadow:0 6px 18px rgba(37,99,235,.25), inset 0 1px 0 rgba(255,255,255,.5);
}
.top5-name{ font-weight:600; }
.top5-meta{ font-size:12px; color:#64748b; }
.top5-qty{ font-weight:700; white-space:nowrap; }
.top5-bar{
  grid-column:2 / span 2; height:6px; background:#eff6ff; border-radius:999px; overflow:hidden;
}
.top5-fill{ height:100%; width:0%; background:linear-gradient(90deg,#93c5fd,#2563eb); }
/* === Mobile polish pack (<= 420px) ====================== */
@media (max-width: 420px){

  /* การ์ด / spacing */
  .card{ padding:12px; border-radius:16px; }
  .section-title{ font-size:15px; }

  /* KPI: ไม่ให้ตัวเลขล้น และอ่านง่ายขึ้น */
  .kpi-row{ grid-template-columns: 1fr 1fr; gap:12px; }  /* จาก 3 กล่อง → 2 กล่อง */
  .kpi-num{ font-size: clamp(18px, 7vw, 26px); padding-left:0; }

  /* แถวแจ้งเตือนใกล้หมด: ตัดคำยาว ๆ ให้พอดี */
  .alert-title, .alert-meta{
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }

  /* Top 5 card header: คุมขนาด selector ให้เล็กลง */
  #topDays, #topMonth, #topYear{
    padding:8px 10px; font-size:14px; height:auto; border-radius:10px;
    max-width: 120px; /* กันกินพื้นที่หัวการ์ด */
  }

  /* รายการ Top 5: กะทัดรัด + ตัดคำยาว */
  .top5-item{
    grid-template-columns:28px 1fr auto;
    padding:10px 12px; border-radius:14px;
  }
  .top5-rank{ width:26px; height:26px; font-size:13px; border-radius:9px; }
  .top5-name{ font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .top5-meta{ font-size:12px; color:#64748b; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .top5-qty{ font-size:14px; }
  .top5-bar{ height:4px; }
}

/* เพิ่มเติม: หน้าจอเล็กมาก (<= 360px) ให้แบ่งเป็นคอลัมน์เดียว */
@media (max-width: 360px){
  .kpi-row{ grid-template-columns: 1fr; }
}

/* ปรับ select ให้ดูเนียนและสั้นลงทุกจอ */
#topDays, #topMonth, #topYear{
  appearance:none;
  background:
    linear-gradient(#fff,#fff) padding-box,
    linear-gradient(180deg,#e2e8f0,#e2e8f0) border-box,
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%2364758b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E") no-repeat right 10px center/ 16px;
  border:1px solid #e2e8f0;
  padding-right:36px;
}

/* ตัดคำยาวในการ์ดทั่วไปให้ไม่ดันเลย์เอาต์ */
.name, .meta{ word-break: break-word; }
/* toolbar ในการ์ดให้ห่อบรรทัดได้ */
.card .toolbar{ display:flex; flex-wrap:wrap; gap:8px; }
.card .toolbar > * { flex: 0 0 auto; }
.card .toolbar .grow{ flex:1 1 auto; }

/* === Toast v2 (Aurora) ================================== */
:root{
  --toast-radius:16px;
  --toast-bg: rgba(255,255,255,.86);
  --toast-bd: rgba(15,23,42,.08);
  --toast-shadow: 0 18px 50px rgba(2,6,23,.18);
}
.noti-stack{
  position:fixed; right:16px; top:14px;
  display:flex; flex-direction:column; gap:10px;
  z-index:5000; pointer-events:none;
}
.noti{
  pointer-events:auto; position:relative;
  min-width:280px; max-width:420px;
  display:grid; grid-template-columns:36px 1fr auto; gap:12px;
  padding:12px 14px 14px;
  background: var(--toast-bg);
  border:1px solid var(--toast-bd);
  border-radius:var(--toast-radius);
  backdrop-filter: blur(14px) saturate(1.2);
  -webkit-backdrop-filter: blur(14px) saturate(1.2);
  box-shadow: var(--toast-shadow);
  transform: translateX(14px);
  opacity:0;
  animation: toastIn .24s cubic-bezier(.2,.9,.2,1) forwards;
  overflow:hidden;
}
.noti::before{
  content:""; position:absolute; left:0; right:0; top:0; height:3px;
  background: var(--accent, #60a5fa);
}
.noti--info   { --accent:#60a5fa; }
.noti--ok     { --accent:#22c55e; }
.noti--warn   { --accent:#f59e0b; }
.noti--danger { --accent:#ef4444; }

.noti__icon{
  width:36px; height:36px; border-radius:12px;
  display:grid; place-items:center; background:#f1f5f9;
  border:1px solid #e5e7eb; box-shadow: inset 0 1px 0 rgba(255,255,255,.6);
}
.noti__icon svg{ width:18px; height:18px; display:block }

.noti__title{ font-weight:700; font-size:14px; letter-spacing:.2px; color:#0f172a }
.noti__msg{ font-size:12px; color:#475569; margin-top:2px }

.noti__close{
  align-self:start; width:28px; height:28px; border:0;
  background:transparent; color:#0f172a; opacity:.5;
  border-radius:8px; cursor:pointer;
}
.noti__close:hover{ opacity:1; background:rgba(15,23,42,.06) }

.noti__progress{
  position:absolute; left:0; right:0; bottom:0; height:2px;
  background: linear-gradient(90deg, var(--accent), transparent);
  transform-origin:left;
  animation: toastLife var(--life, 2800ms) linear forwards;
}
.noti.paused .noti__progress{ animation-play-state: paused }

.noti.out{ animation: toastOut .2s ease forwards }

@keyframes toastIn{
  from{ opacity:0; transform: translateX(12px) translateY(-4px) scale(.98) }
  to  { opacity:1; transform: translateX(0) translateY(0) scale(1) }
}
@keyframes toastOut{
  to{ opacity:0; transform: translateX(12px) translateY(-4px) scale(.98) }
}
@keyframes toastLife{
  from{ transform: scaleX(1) } to{ transform: scaleX(0) }
}

/* small screen tune */
@media (max-width:480px){
  .noti-stack{ right:10px; left:10px }
  .noti{ max-width:unset }
}

/* ======== OVERRIDES (Minimal + Mobile, esp. Dashboard & Top5) ========= */

/* iOS safe-area + ป้องกัน zoom-font */
html{ -webkit-text-size-adjust: 100%; }
body{ padding-bottom: env(safe-area-inset-bottom); }

/* Global card more minimal */
.card{ border:1px solid #e5e7eb; box-shadow:none; border-radius:16px; }
.card.soft{ border-radius:16px; }

/* Dashboard: compact KPI & alerts */
@media (max-width: 820px){ .kpi-row{ grid-template-columns:1fr 1fr; gap:12px; } }
.kpi-num{ font-size: clamp(18px, 7vw, 28px); padding-left:0; }

.alert-list{ gap:10px; }
.alert-item{ overflow:hidden; align-items:flex-start; }
.alert-title,.alert-meta{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* ---- Top 5 (fit-to-screen, iPhone friendly) ---- */
#page-dashboard .card.soft{ padding:12px; border-radius:16px; overflow:hidden; }
#page-dashboard .top5-list{ margin:0; padding:0; gap:12px; }
#page-dashboard .top5-item{
  box-sizing:border-box; width:100%; max-width:100%;
  border:1px solid var(--line); border-radius:14px; background:#fff;
  overflow:hidden;
  display:grid; grid-template-columns:36px 1fr auto; gap:10px; padding:10px 12px;
}
#page-dashboard .top5-item > *{ min-width:0; }
#page-dashboard .top5-name{
  font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
#page-dashboard .top5-meta{
  font-size:12px; color:#64748b; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
#page-dashboard .top5-qty{ white-space:nowrap; text-align:right; font-weight:700; }
#page-dashboard .top5-bar{
  grid-column:2 / span 2; width:100%; max-width:100%;
  height:6px; margin-top:6px; background:#eff3fb;
  border-radius:999px; overflow:hidden;
}
#page-dashboard .top5-fill{
  height:100%; width:0%; max-width:100%;
  display:block; transform:translateZ(0);
  background:linear-gradient(90deg,#93c5fd,#2563eb);
}
@media (max-width:430px){
  #page-dashboard .top5-item{ grid-template-columns:28px 1fr auto; border-radius:16px; }
  #page-dashboard .top5-rank{ width:26px; height:26px; border-radius:9px; font-size:13px; }
  #page-dashboard .top5-name{ font-size:14px; }
  #page-dashboard .top5-qty{ font-size:14px; }
  #page-dashboard .top5-bar{ height:5px; }
}

/* ป้องกันแนวนอนล้นหน้าจอ */
.container{ overflow-x:hidden; }

/* History — badges compact inside row-cards (ไม่ล้นมุม) */
#page-history .tbl tbody td{ vertical-align:middle; }
#page-history .tbl tbody td:first-child,
#page-history .tbl tbody td:last-child{ overflow:hidden; }
#page-history .badge{
  display:inline-flex; align-items:center; justify-content:center;
  height:26px; padding:0 10px; font-size:12px; line-height:1;
  border-radius:999px; white-space:nowrap; box-shadow:none;
}
#page-history .badge.in{ background:#ecfdf5; border:1px solid #a7f3d0; color:#047857; }
#page-history .badge.out{ background:#fee2e2; border:1px solid #fecaca; color:#b91c1c; }
#page-history .tbl tbody td:nth-child(4){ width:1%; white-space:nowrap; }

/* Gallery text clamp */
.gbox .name, .gbox .meta{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* Bottom-nav safe width */
.bottom-nav{ width:min(820px,96vw); left:50%; transform:translateX(-50%); padding-bottom:max(0px, env(safe-area-inset-bottom)); }

/* ===== Bottom Nav — Phone perfect fit (force single-line labels) ===== */
.bottom-nav{
  box-sizing:border-box;
  width: min(100vw - 16px, 820px);
  padding: 0 8px;
  overflow: hidden;                 /* กันอะไรกระดอนล้นกรอบ */
  border-radius: 18px;
}

.bottom-nav .nav-btn{
  gap: 2px;
  padding-top: 4px; padding-bottom: 4px;
  min-width: 0;                     /* ให้คำนวณความกว้างแบบยืดหยุ่นได้จริง */
}

.bottom-nav .nav-btn span{
  display:block;
  white-space: nowrap;              /* ห้ามขึ้นบรรทัดใหม่ */
  overflow: hidden;                 /* ถ้ายาวเกิน ให้ซ่อน */
  text-overflow: ellipsis;          /* … แทนตัวที่หายไป */
  word-break: keep-all;
}

/* ปรับให้ไฮไลต์ (ตัวบั้มขาว) ไม่ทับตัวหนังสือ/ไอคอน */
.bottom-nav::after{
  top: 8px; bottom: 8px;            /* ลดความสูงของตัวไฮไลต์ */
  border-radius: 12px;
}

/* iPhone 15 และมือถือช่วงเดียวกัน */
@media (max-width: 430px){
  .bottom-nav{ height:64px; }
  .bottom-nav .nav-btn{ font-size:20px; }
  .bottom-nav .nav-btn span{
    font-size: 11px;
    max-width: calc((100vw - 16px)/var(--count) - 14px); /* คิดตามจำนวนปุ่ม */
  }
}

/* จอเล็กมาก (เช่นรุ่น mini/SE) */
@media (max-width: 360px){
  .bottom-nav{ height:60px; }
  .bottom-nav .nav-btn{ font-size:19px; }
  .bottom-nav .nav-btn span{
    font-size: 10.5px;
    max-width: calc((100vw - 16px)/var(--count) - 12px);
  }
}

/* กันหน้าเว็บลื่นออกจอแนวนอนบน iOS */
html, body, .container{ overflow-x:hidden; }

